attackerLocated(internet).
attackGoal(execCode(workStation,_)).

hacl(internet, webServer, _, _).
hacl(webServer, _,  _, _).
hacl(fileServer, _, _, _).
hacl(workStation, _, _, _).
hacl(H,H,_,_).

/* configuration information of fileServer */
networkServiceInfo(fileServer, _, _, _, root).
nfsExportInfo(fileServer, '/export', _anyAccess, workStation).
nfsExportInfo(fileServer, '/export', _anyAccess, webServer).
vulExists(fileServer, '224.0.0.251', _).
vulProperty('224.0.0.251', remoteExploit, privEscalation).
localFileProtection(fileServer, root, _, _).

/* configuration information of webServer */
vulExists(webServer, '224.0.0.251', _).
vulProperty('224.0.0.251', remoteExploit, privEscalation).
networkServiceInfo(webServer, _, _, _, _).

/* configuration information of workStation */
nfsMounted(workStation, '/usr/local/share', fileServer, '/export', read).attackerLocated(internet).
attackGoal(execCode(workStation,_)).

hacl(internet, webServer, _, _).
hacl(webServer, _,  _, _).
hacl(fileServer, _, _, _).
hacl(workStation, _, _, _).
hacl(H,H,_,_).

/* configuration information of fileServer */
networkServiceInfo(fileServer, _, _, _, root).
nfsExportInfo(fileServer, '/export', _anyAccess, workStation).
nfsExportInfo(fileServer, '/export', _anyAccess, webServer).
vulExists(fileServer, 'CVE-2018-1050', _).
vulProperty('CVE-2018-1050', remoteExploit, privEscalation).
localFileProtection(fileServer, root, _, _).

/* configuration information of webServer */
vulExists(webServer, 'CVE-2022-0336', _).
vulProperty('CVE-2022-0336', remoteExploit, privEscalation).
networkServiceInfo(webServer, _, _, _, _).

/* configuration information of workStation */
nfsMounted(workStation, '/usr/local/share', fileServer, '/export', read).attackerLocated(internet).
attackGoal(execCode(workStation,_)).

hacl(internet, webServer, _, _).
hacl(webServer, _,  _, _).
hacl(fileServer, _, _, _).
hacl(workStation, _, _, _).
hacl(H,H,_,_).

/* configuration information of fileServer */
networkServiceInfo(fileServer, _, _, _, root).
nfsExportInfo(fileServer, '/export', _anyAccess, workStation).
nfsExportInfo(fileServer, '/export', _anyAccess, webServer).
vulExists(fileServer, 'CVE-2018-14629', _).
vulProperty('CVE-2018-14629', remoteExploit, privEscalation).
localFileProtection(fileServer, root, _, _).

/* configuration information of webServer */
vulExists(webServer, 'CVE-2022-32744', _).
vulProperty('CVE-2022-32744', remoteExploit, privEscalation).
networkServiceInfo(webServer, _, _, _, _).

/* configuration information of workStation */
nfsMounted(workStation, '/usr/local/share', fileServer, '/export', read).attackerLocated(internet).
attackGoal(execCode(workStation,_)).

hacl(internet, webServer, _, _).
hacl(webServer, _,  _, _).
hacl(fileServer, _, _, _).
hacl(workStation, _, _, _).
hacl(H,H,_,_).

/* configuration information of fileServer */
networkServiceInfo(fileServer, _, _, _, root).
nfsExportInfo(fileServer, '/export', _anyAccess, workStation).
nfsExportInfo(fileServer, '/export', _anyAccess, webServer).
vulExists(fileServer, 'CVE-2021-3738', _).
vulProperty('CVE-2021-3738', remoteExploit, privEscalation).
localFileProtection(fileServer, root, _, _).

/* configuration information of webServer */
vulExists(webServer, 'CVE-2021-36368', _).
vulProperty('CVE-2021-36368', remoteExploit, privEscalation).
networkServiceInfo(webServer, _, _, _, _).

/* configuration information of workStation */
nfsMounted(workStation, '/usr/local/share', fileServer, '/export', read).